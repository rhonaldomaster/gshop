# üì± Home Screen Functionality Implementation Plan

## üéØ Objetivo
Hacer que todos los elementos de la pantalla Home sean completamente funcionales, incluyendo b√∫squeda, categor√≠as, productos y quick actions.

---

## üóÉÔ∏è Setup Inicial: Datos de Prueba

**IMPORTANTE:** Antes de empezar con la implementaci√≥n, necesitas poblar la base de datos con datos de prueba.

### Comando para Seed
```bash
npm run db:seed
```

### Datos que se crear√°n:

#### üë• Usuarios de Prueba
- **Admin:** `john@doe.com` / `johndoe123`
- **Seller:** `seller@gshop.com` / `seller123`
- **Buyer:** `buyer@gshop.com` / `buyer123`
- **Test User (ya creado):** `test@test.com` / `123456`

#### üìÇ Categor√≠as
- **Electronics** (con subcategor√≠as: Smartphones, Laptops)
- **Fashion** (con subcategor√≠as: Men's Clothing, Women's Clothing)
- **Home & Garden**

#### üõçÔ∏è Productos de Prueba
1. **iPhone 15 Pro Max** - $1,299,999.99 ARS
   - Categor√≠a: Smartphones
   - 25 unidades en stock
   - Variantes: Color (4 opciones), Storage (3 opciones)
   - Im√°genes reales desde URLs

2. **MacBook Air 15" M3** - $1,749,999.99 ARS
   - Categor√≠a: Laptops
   - 15 unidades en stock
   - Variantes: Color (4 opciones), Memory (3 opciones), Storage (4 opciones)

3. **Premium Cotton T-Shirt** - $15,999.99 ARS
   - Categor√≠a: Men's Clothing
   - 100 unidades en stock
   - Variantes: Size (6 opciones), Color (5 opciones)

#### üí∞ Comisiones Configuradas
- Platform Fee: 7%
- Seller Premium: 2%
- Referral Bonus: 1%

### Verificar Datos
```bash
# Contar productos
psql -d gshop_db -c "SELECT COUNT(*) FROM product;"

# Ver productos
psql -d gshop_db -c "SELECT id, name, price FROM product;"

# Ver categor√≠as
psql -d gshop_db -c "SELECT id, name, slug FROM category;"
```

---

## üìã Checklist de Implementaci√≥n

### 1. üîç B√∫squeda Funcional
**Status:** ‚úÖ Completado
**Archivos:** `HomeScreen.tsx`, `SearchScreen.tsx`, `products.service.ts`

#### Tareas:
- [x] Conectar bot√≥n de b√∫squeda con navegaci√≥n a SearchScreen
- [x] Implementar servicio de b√∫squeda de productos en `products.service.ts`
  - Endpoint: `GET /api/v1/products/search?search={query}`
  - Soporte para filtros (categor√≠a, precio, rating)
- [x] Actualizar SearchScreen para:
  - Mostrar resultados reales desde API
  - Implementar b√∫squeda en tiempo real (debounce 300ms)
  - Agregar filtros avanzados (precio, categor√≠a, rating)
  - Mostrar estado de loading y empty state
  - Manejar errores de red

#### C√≥digo necesario:
```typescript
// En HomeScreen.tsx l√≠nea 73
<TouchableOpacity
  style={styles.searchButton}
  onPress={() => navigation.navigate('Search')}
>
  <Ionicons name="search" size={24} color="#6B7280" />
</TouchableOpacity>

// En products.service.ts
async searchProducts(query: string, filters?: ProductFilters): Promise<Product[]> {
  const params = new URLSearchParams({
    q: query,
    ...filters,
  });
  const response = await apiClient.get<Product[]>(`/products/search?${params}`);
  return response.data;
}
```

---

### 2. üìÇ Categor√≠as Clickeables
**Status:** ‚úÖ Completado
**Archivos:** `HomeScreen.tsx`, `CategoryProductsScreen.tsx`, `products.service.ts`

#### Tareas:
- [x] Crear pantalla CategoryScreen para mostrar productos por categor√≠a
- [x] Implementar navegaci√≥n desde categor√≠as en HomeScreen
- [x] Crear servicio para obtener productos por categor√≠a
  - Endpoint: `GET /api/v1/products/category/{categoryId}`
- [x] Agregar paginaci√≥n para resultados de categor√≠a
- [x] Implementar "View All" para mostrar todas las categor√≠as
- [x] Sincronizar categor√≠as con backend (categor√≠as reales desde API)

#### Estructura CategoryScreen:
```typescript
// Crear: src/screens/categories/CategoryScreen.tsx
interface CategoryScreenProps {
  route: { params: { categoryId: string; categoryName: string } }
}

// Features:
- Header con nombre de categor√≠a
- Grid de productos filtrados
- Filtros de precio y rating
- Paginaci√≥n infinita
- Pull to refresh
```

---

### 3. üõçÔ∏è Detalles de Productos
**Status:** ‚úÖ Completado
**Archivos:** `HomeScreen.tsx`, `ProductDetailScreen.tsx`, `products.service.ts`

#### Tareas:
- [x] Conectar cards de productos con navegaci√≥n a ProductDetailScreen
- [x] Implementar servicio para obtener detalles de producto
  - Endpoint: `GET /api/v1/products/:id`
- [x] Actualizar ProductDetailScreen para:
  - Mostrar informaci√≥n completa del producto
  - Galer√≠a de im√°genes con carousel
  - Bot√≥n "Add to Cart" funcional
  - Reviews y ratings
  - Productos relacionados
  - Opciones de env√≠o
  - Descripci√≥n expandible

#### C√≥digo necesario:
```typescript
// En HomeScreen.tsx l√≠nea 143
<TouchableOpacity
  style={styles.productCard}
  onPress={() => navigation.navigate('ProductDetail', { productId: item.id })}
>
  {/* ... producto card ... */}
</TouchableOpacity>

// En products.service.ts
async getProductDetails(productId: string): Promise<ProductDetails> {
  const response = await apiClient.get<ProductDetails>(`/products/${productId}`);
  return response.data;
}
```

---

### 4. ‚ö° Quick Actions Funcionales
**Status:** ‚úÖ Completado
**Archivos:** `HomeScreen.tsx`, pantallas existentes

#### Tareas:
- [x] **My Orders** (l√≠nea 263)
  - Navegar a OrdersScreen
  - Mostrar historial de √≥rdenes del usuario

- [x] **Wishlist** (l√≠nea 273)
  - Navegar a WishlistScreen
  - Mostrar productos guardados

- [x] **Payments** (l√≠nea 283)
  - Navegar a PaymentMethodsScreen
  - Mostrar m√©todos de pago guardados

#### C√≥digo necesario:
```typescript
// En HomeScreen.tsx
const navigation = useNavigation();

// My Orders
<TouchableOpacity
  style={styles.quickAction}
  onPress={() => navigation.navigate('Orders')}
>

// Wishlist
<TouchableOpacity
  style={styles.quickAction}
  onPress={() => navigation.navigate('Wishlist')}
>

// Payments
<TouchableOpacity
  style={styles.quickAction}
  onPress={() => navigation.navigate('PaymentMethods')}
>
```

---

### 5. üé® Hero Banner "Shop Now"
**Status:** ‚úÖ Completado
**Archivos:** `HomeScreen.tsx`

#### Tareas:
- [x] Implementar navegaci√≥n del bot√≥n "Shop Now" (l√≠nea 139)
- [x] Opciones:
  - Navegar a categor√≠a destacada
  - Navegar a p√°gina de ofertas/sale
  - Navegar a productos trending (implementado)

#### C√≥digo necesario:
```typescript
<GSButton
  title="Shop Now"
  variant="secondary"
  size="medium"
  fullWidth={false}
  style={styles.heroButton}
  onPress={() => navigation.navigate('Sale')} // o 'Trending'
/>
```

---

### 6. üîó "View All" Links
**Status:** ‚úÖ Completado
**Archivos:** `HomeScreen.tsx`

#### Tareas:
- [x] Implementar "View All" para categor√≠as (l√≠nea 153)
  - Navegar a pantalla de todas las categor√≠as

- [x] Implementar "View All" para productos destacados (l√≠nea 199)
  - Navegar a pantalla de todos los productos o productos destacados (Trending)

#### C√≥digo necesario:
```typescript
// View All Categor√≠as
<TouchableOpacity onPress={() => navigation.navigate('AllCategories')}>
  <GSText variant="body" style={{ color: theme.colors.primary }}>
    View All
  </GSText>
</TouchableOpacity>

// View All Productos
<TouchableOpacity onPress={() => navigation.navigate('AllProducts', { filter: 'featured' })}>
  <GSText variant="body" style={{ color: theme.colors.primary }}>
    View All
  </GSText>
</TouchableOpacity>
```

---

## üèóÔ∏è Nuevas Pantallas Necesarias

### 1. CategoryScreen.tsx
- **Ruta:** `src/screens/categories/CategoryScreen.tsx`
- **Props:** `{ categoryId, categoryName }`
- **Features:** Grid de productos, filtros, paginaci√≥n

### 2. AllCategoriesScreen.tsx
- **Ruta:** `src/screens/categories/AllCategoriesScreen.tsx`
- **Features:** Lista completa de categor√≠as con im√°genes

### 3. SaleScreen.tsx / TrendingScreen.tsx
- **Ruta:** `src/screens/products/SaleScreen.tsx`
- **Features:** Productos en oferta con countdown timer

---

## üîå API Endpoints Necesarios

### Backend debe implementar:
```
GET  /api/v1/products/search?q={query}&category={id}&minPrice={price}&maxPrice={price}
GET  /api/v1/products?category={categoryId}&page={page}&limit={limit}
GET  /api/v1/products/{id}
GET  /api/v1/products/trending
GET  /api/v1/products/featured
GET  /api/v1/categories
GET  /api/v1/categories/{id}/products
```

---

## üì¶ Servicios a Actualizar

### `products.service.ts`
```typescript
class ProductsService {
  // ‚úÖ Ya existe
  async getProducts(params?: ProductQueryParams): Promise<Product[]>

  // üÜï Agregar
  async searchProducts(query: string, filters?: ProductFilters): Promise<Product[]>
  async getProductDetails(id: string): Promise<ProductDetails>
  async getProductsByCategory(categoryId: string, page?: number): Promise<PaginatedProducts>
  async getTrendingProducts(): Promise<Product[]>
  async getFeaturedProducts(): Promise<Product[]>
  async getRelatedProducts(productId: string): Promise<Product[]>
}
```

### `categories.service.ts` (crear)
```typescript
class CategoriesService {
  async getAllCategories(): Promise<Category[]>
  async getCategoryDetails(id: string): Promise<CategoryDetails>
  async getCategoryProducts(id: string, page?: number): Promise<PaginatedProducts>
}
```

---

## üéØ Orden de Implementaci√≥n Sugerido

### Fase 1: Navegaci√≥n B√°sica (1-2 horas)
1. ‚úÖ Conectar bot√≥n de b√∫squeda ‚Üí SearchScreen
2. ‚úÖ Conectar productos ‚Üí ProductDetailScreen
3. ‚úÖ Conectar Quick Actions ‚Üí Pantallas existentes
4. ‚úÖ Implementar useNavigation en HomeScreen

### Fase 2: Productos y Detalles (2-3 horas)
1. ‚úÖ Actualizar ProductDetailScreen con datos reales
2. ‚úÖ Implementar servicio getProductDetails
3. ‚úÖ Agregar "Add to Cart" funcional
4. ‚úÖ Mostrar productos relacionados

### Fase 3: B√∫squeda (2-3 horas)
1. ‚úÖ Implementar servicio searchProducts
2. ‚úÖ Actualizar SearchScreen con resultados reales
3. ‚úÖ Agregar filtros avanzados
4. ‚úÖ Implementar debounce para b√∫squeda en tiempo real

### Fase 4: Categor√≠as (2-3 horas)
1. ‚úÖ Crear CategoryScreen
2. ‚úÖ Implementar servicio de categor√≠as
3. ‚úÖ Conectar categor√≠as ‚Üí CategoryScreen
4. ‚úÖ Crear AllCategoriesScreen

### Fase 5: Features Adicionales (1-2 horas)
1. ‚úÖ Implementar hero banner navigation
2. ‚úÖ Crear SaleScreen/TrendingScreen
3. ‚úÖ Implementar "View All" links
4. ‚úÖ Agregar pull-to-refresh en Home

---

## üìù Notas de Implementaci√≥n

### Consideraciones:
- Usar `useNavigation` hook de React Navigation
- Mantener TypeScript strict mode
- Implementar loading states con skeleton screens
- Agregar error handling con fallback UI
- Usar el hook `useProducts` existente donde sea posible
- Implementar optimistic updates para mejor UX
- Agregar analytics tracking para eventos de navegaci√≥n

### Performance:
- Implementar paginaci√≥n infinita para listados
- Usar FlatList con optimizaciones (windowSize, maxToRenderPerBatch)
- Cachear resultados de b√∫squeda con AsyncStorage
- Lazy load de im√°genes con placeholder

### UX:
- Agregar animaciones de transici√≥n entre pantallas
- Implementar gestos de swipe (back, refresh)
- Mostrar estados vac√≠os con ilustraciones
- Agregar haptic feedback en iOS

---

## ‚úÖ Criterios de Aceptaci√≥n

- [x] Todos los botones y elementos clickeables tienen funcionalidad
- [x] Navegaci√≥n fluida sin crashes
- [x] Datos reales desde API (no mock data)
- [x] Estados de loading, error y vac√≠o implementados
- [x] Im√°genes de productos se cargan correctamente
- [x] B√∫squeda funciona en tiempo real
- [x] Filtros de categor√≠as funcionan
- [x] Add to cart funciona desde detalles de producto
- [x] Quick actions navegan a pantallas correctas
- [x] No hay console warnings o errors

---

## üöÄ Estado Final

### ‚úÖ IMPLEMENTACI√ìN COMPLETADA AL 100%

Todas las fases del plan han sido completadas exitosamente:

1. ‚úÖ **Fase 1:** Navegaci√≥n B√°sica - Completada
2. ‚úÖ **Fase 2:** Productos y Detalles - Completada
3. ‚úÖ **Fase 3:** B√∫squeda - Completada
4. ‚úÖ **Fase 4:** Categor√≠as - Completada
5. ‚úÖ **Fase 5:** Features Adicionales - Completada

### üîß Correcciones Recientes (2025-10-05)
- Fixed backend search endpoint SQL error (tags field handling)
- Fixed parameter mapping (`query` ‚Üí `search`)
- Fixed search input text visibility
- Fixed Filters button vertical alignment

### üìä Endpoints Verificados
- ‚úÖ `GET /api/v1/products/search` - Working
- ‚úÖ `GET /api/v1/products/trending` - Working
- ‚úÖ `GET /api/v1/products/categories` - Working
- ‚úÖ `GET /api/v1/products/category/:id` - Working
- ‚úÖ `GET /api/v1/products/:id` - Working

---

**√öltima actualizaci√≥n:** 2025-10-05
**Estado:** ‚úÖ Completado
**Tiempo real de desarrollo:** ~10 horas
